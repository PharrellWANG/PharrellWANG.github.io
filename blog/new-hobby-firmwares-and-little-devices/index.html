<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charSet="utf-8" class="next-head next-head"/><title class="jsx-1639712269 jsx-1639712269 next-head">New Hobby: Firmwares and Little Devices</title><meta name="description" content="I started playing with Arduino and chips like ESP8266. It was fun and that&#x27;s my hobby now." class="jsx-1639712269 jsx-1639712269 next-head"/><link rel="preload" href="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/page/blog/new-hobby-firmwares-and-little-devices.js" as="script"/><link rel="preload" href="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/page/_error.js" as="script"/><link rel="preload" href="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/main.js" as="script"/><style id="jss-server-side"></style><style id="__jsx-1319436554">.jsx-1319436554{margin:15px 0;}</style><style id="__jsx-1221164359">.container.jsx-1221164359{text-align:center;max-width:100%;margin:50px 0;}img.jsx-1221164359{max-width:100%;}.title.jsx-1221164359{color:#888;font-size:13px;line-height:17px;padding:5px 0;}.title.jsx-1221164359 div.jsx-1221164359{margin:0;}</style><style id="__jsx-3732062809">span.jsx-3732062809{font-family:'SFMono-Regular',Consolas,'Liberation Mono',Menlo, Courier,monospace;padding:2px 5px;margin:0;font-size:85%;background-color:#f5f5f5;border-radius:3px;}</style><style id="__jsx-124958280">.code.jsx-124958280{margin:30px 0;}</style><style id="__jsx-1764193600">.spanPaddingRight.jsx-1639712269{display:block;margin:0 auto 0 auto;max-width:650px;padding:0 21px;}.span.jsx-1639712269{padding-left:30px;}.backIcon.jsx-1639712269{padding-right:6px;}a.jsx-1639712269{color:#3f51b5;-webkit-text-decoration:none;text-decoration:none;opacity:1;}a.jsx-1639712269:hover{color:#3f51b5;-webkit-text-decoration:none;text-decoration:none;opacity:0.7;}.footerWrapper.jsx-1639712269{margin-top:72px;border-top:1px solid #666;backgroundcolor:#fff;height:120px;z-index:1100;}.copyright.jsx-1639712269{-webkit-flex:1;-ms-flex:1;flex:1;padding-top:36px;text-align:center;}.headerTop.jsx-1639712269{padding-top:21px;padding-bottom:21px;background-color:#fff;border-bottom:1px solid #8bc34a;}.outerContainer.jsx-1639712269{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:#fafafa;width:100%;height:100%;}.innerContainer.jsx-1639712269{padding:0 21px;-webkit-flex:1;-ms-flex:1;flex:1;}.content.jsx-1639712269{margin:0 auto 0 auto;max-width:650px;padding-top:24px;}.content.jsx-1639712269 h1.jsx-1639712269{font-size:2.125rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.15417em;color:rgba(0,0,0,0.54);}.date.jsx-1639712269{color:#888;font-size:13px;padding-top:3px;}.markdown-content.jsx-1639712269{margin:50px 0 0 0;}</style><style id="__jsx-1095102180">.markdown-content{color:rgba(0,0,0,0.87);line-height:1.46429em;font-size:1.115rem;font-weight:400;}.markdown-content hr{border:0;border-bottom:1px solid #8bc34a;margin:40px 60px;}.markdown-content a{color:#1e88e5;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #1e88e5;}.markdown-content strong{font-weight:500;-webkit-text-decoration:none;text-decoration:none;}.markdown-content li{margin:10px 0;font-size:1rem;}.markdown-content h2{font-size:1.45rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.15417em;color:rgba(0,0,0,0.87);}.markdown-content h3{font-size:1.2rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.15417em;text-transform:uppercase;color:rgba(0,0,0,0.87);}.markdown-content blockquote{padding:1px 0 1px 15px;margin:0;border-left:5px solid #8bc34a;}</style><style id="__jsx-1580160015"></style><style id="__jsx-3994937953">body{font-family:Roboto,-apple-system,BlinkMacSystemFont,'Segoe UI', Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol';padding:0;margin:0;-webkit-font-smoothing:antialiased;}</style><title>Pharrell&#x27;s Home Page</title><meta charSet="utf-8"/><meta name="viewport" content="user-scalable=0, initial-scale=1, minimum-scale=1, width=device-width, height=device-height"/><meta name="theme-color" content="#4caf50"/><link rel="favicon.ico" sizes="512x512" href="/static/favicons/favicon.ico"/><link rel="apple-touch-icon" sizes="72x72" href="/static/favicons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/favicons/icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/favicons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/favicons/icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/static/favicons/icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/icon-180x180.png"/><link rel="apple-touch-icon" sizes="192x192" href="/static/favicons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="384x384" href="/static/favicons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/static/favicons/icon-512x512.png"/><link rel="icon" type="image/png" href="/static/favicons/favicon.ico" sizes="512x512"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500"/><link href="https://fonts.googleapis.com/css?family=Kalam" rel="stylesheet"/></head><body><div id="__next"><div class="jsx-4078088743 jsx-4078088743" data-reactroot=""><article class="jsx-4078088743 jsx-4078088743"><main class="jsx-1639712269 jsx-1639712269 outerContainer"><div class="jsx-1639712269 jsx-1639712269 headerTop"><span class="jsx-1639712269 jsx-1639712269 spanPaddingRight"><a href="/blog" class="jsx-1639712269 jsx-1639712269">&lt; Go back</a></span></div><div class="jsx-1639712269 jsx-1639712269 innerContainer"><div class="jsx-1639712269 jsx-1639712269 content"><div class="jsx-1639712269 jsx-1639712269 date">Published on <!-- -->October 24, 2017</div><h1 class="jsx-1639712269 jsx-1639712269">New Hobby: Firmwares and Little Devices</h1><div class="jsx-1639712269 jsx-1639712269 markdown-content"><div class="_markdown_"><div class="jsx-1319436554 jsx-1319436554">I started coding around ten years ago and I still love it. But honestly, sometimes it&#x27;s boring to do the same thing for a long time.</div><blockquote><div class="jsx-1319436554 jsx-1319436554">Fortunately, my employer gives me quite impressive challenges and I&#x27;m not bored with my job.<br/><small>(I had to add this, otherwise you know :D).</small></div></blockquote><hr/><div class="jsx-1319436554 jsx-1319436554">I tried doing some machine learning (and deep learning) stuff. Those are very challenging, but I couldn&#x27;t go too far. (Maybe that&#x27;s something too challenging for me.)</div><div class="jsx-1319436554 jsx-1319436554">Of course, I studied a bit about cryptocurrencies, like Bitcoin and Steemit, and I read a lot of papers. I know most of them are not scams, but they rely heavily on speculation and risk.</div><div class="jsx-1319436554 jsx-1319436554">That&#x27;s not worth my time. (And I don&#x27;t have money to risk.)</div><h2>Little Devices</h2><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31915499-4f8950be-b86c-11e7-86aa-760dcd9a83a8.jpeg" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">One of my WiFi device experiment.</div></div></div><div class="jsx-1319436554 jsx-1319436554">As you can see, I&#x27;m playing around with some little devices. Some of these tools may be pretty new to you. Don&#x27;t worry, I was just like you a few week&#x27;s back.</div><div class="jsx-1319436554 jsx-1319436554">This is how I got started.</div><div class="jsx-1319436554 jsx-1319436554">I am building a new house and I wanted to make it a Smart Home. So, I was searching for devices and systems I could use. I already bought a <a href="http://www2.meethue.com/en-us">Phillips Hue Kit</a> and a set of Hue bulbs.</div><div class="jsx-1319436554 jsx-1319436554">So, I was wondering, what if I could build them from scratch?</div><div class="jsx-1319436554 jsx-1319436554">That&#x27;s a really good challenge, and I thought it would be cheaper as well.</div><blockquote><div class="jsx-1319436554 jsx-1319436554">But that&#x27;s fake news. You can buy a Philips Hue WiFi bulb for less than <a href="http://www2.meethue.com/en-us/p/hue-white-4-pack-e26/46677472023">$15 </a> and there are a ton of <a href="https://goo.gl/Ny2vTV">cheap smart home</a> solutions on eBay.<br/></div></blockquote><h2>Arduino</h2><div class="jsx-1319436554 jsx-1319436554"><a href="https://www.arduino.cc/">Arduino</a>: this is where anyone would start,  because it&#x27;s that popular. Just like everyone, I ordered a Arduino Kit from a local dealer.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31915712-1b3ae510-b86d-11e7-9351-a4eb070a51a6.jpg" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">My Arduino kit. It&#x27;s a locally assembled kit.</div></div></div><div class="jsx-1319436554 jsx-1319436554">I also found a very nice website: <a href="https://www.tinkercad.com/circuits">Tinkercad Circuits</a>. It&#x27;s a way to refresh my high school electronic lessons and play around with them in a virtual environment.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31915786-6d79e9fc-b86d-11e7-9b75-c62791f302ef.png" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">A simple capacitor experiment in Tinkercad.</div></div></div><div class="jsx-1319436554 jsx-1319436554">Using my Arduino kit, I played around a bit and I blinked some LEDs and turned on some motors. That was fun. However, my fun was limited because my Arduino kit had only a few components.</div><div class="jsx-1319436554 jsx-1319436554">So, I ordered a sensor kit from eBay and it is on its way. I&#x27;ll have some busy weekends soon.</div><blockquote><div class="jsx-1319436554 jsx-1319436554">My wife will definitely hate this as she&#x27;ll lose some shopping time.<br/>She&#x27;s also worried about me as I blew up a few components with smoke.<br/><small>(I was supplying AC current to a DC-to-DC step-down converter, assuming it&#x27;s an AC to DC one.)</small></div></blockquote><h3>Fun facts</h3><div class="jsx-1319436554 jsx-1319436554">Even thought Arduino is so popular, there are nearly no production devices built on top of Arduino. Do you know why?</div><div class="jsx-1319436554 jsx-1319436554">Because it&#x27;s a development platform for a microcontroller series called <a href="https://en.wikipedia.org/wiki/ATmega328">Atmel ATmega</a>. Arduino has a pretty solid IDE, active developer base and a lot of modules like sensors and activators. That&#x27;s why it&#x27;s so popular.</div><div class="jsx-1319436554 jsx-1319436554">After developers have prototyped with it, they can build real world products using the ATmega microcontroller or something else that is better suited.</div><h2>Meet ESP8266</h2><div class="jsx-1319436554 jsx-1319436554">If you are not much into this kind of stuff, I am pretty sure you haven&#x27;t heard about <a href="http://espressif.com/en/products/hardware/esp8266ex/overview">ESP8266</a>.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31915956-272950c2-b86e-11e7-9a4e-0eba9e6e22f1.jpg" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">ESP8266-01: See how small it is.</div></div></div><div class="jsx-1319436554 jsx-1319436554">This is a very small chip that costs <a href="https://goo.gl/QuvLsp">less than $2</a>. But it has really good specs compared with Arduino (Atmel ATmega). Let me show you a few of them:</div><ul><li>A complete WiFi stack, which can be used as a station, an access point or both at once.</li><li>A complete TCP/IP stack with some cool libraries (such as <a href="https://en.wikipedia.org/wiki/Multicast_DNS">mDNS</a>)</li><li>4MB Flash (compared to 32KB Flash in Arduino)</li><li>64KB RAM (compared to 2KB in Arduino)</li><li>GPIO ports (ranging from 2 to 16 in different models)</li></ul><h3>Getting started</h3><div class="jsx-1319436554 jsx-1319436554">You can use the Arduino IDE to program ESP8266 and it&#x27;s a pretty active and a <a href="https://github.com/esp8266/Arduino">solid module</a>.</div><blockquote><div class="jsx-1319436554 jsx-1319436554">They have already <a href="https://github.com/esp8266/Arduino/issues/3725">fixed</a> the recent WPA <a href="https://www.krackattacks.com/">KRACK</a> attack.</div></blockquote><div class="jsx-1319436554 jsx-1319436554">But, this is a chip. It&#x27;s not a developer friendly tool like Arduino.</div><div class="jsx-1319436554 jsx-1319436554">Fortunately, there are development boards based on ESP8266 like <a href="https://en.wikipedia.org/wiki/NodeMCU">NodeMCU</a>. But, I didn&#x27;t like that option. I wanted the raw experiences. So, I experimented a bit with ESP8266 and I got it working with the help of an Arduino.</div><div class="jsx-1319436554 jsx-1319436554">But it was a chunky setup and things didn&#x27;t worked really well.</div><div class="jsx-1319436554 jsx-1319436554">Apparently, the root problem was the power supply. For an Arduino, it&#x27;s quite okay to run it with USB power because Atmel ATmega is a pretty small chip. But ESP8266 is a pretty big one and it needs more power. The USB power that comes with the Arduino board is not good enough for it.</div><div class="jsx-1319436554 jsx-1319436554">So, I experimented (and shopped) a little bit and came up with this setup.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31915499-4f8950be-b86c-11e7-86aa-760dcd9a83a8.jpeg" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">My initial ESP8266 setup.</div></div></div><div class="jsx-1319436554 jsx-1319436554">Now that it has its own power supply and direct USB connection bypassing Arduino via PL2303, it was working perfectly and I really liked it.</div><div class="jsx-1319436554 jsx-1319436554">I&#x27;ll save the details for a another blog post. It&#x27;s a lot of information.</div><h3>Dev Board</h3><div class="jsx-1319436554 jsx-1319436554">This setup works. But as you can see, there are a lot of wirings and it&#x27;s really painful to set up from scratch. So, I came up with a simple, but useful dev board for my ESP8266.</div><div class="jsx-1319436554 jsx-1319436554">Here it is:</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31916207-2e5c7382-b86f-11e7-859e-74405c6508f5.jpeg" width="400" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">My ESP8266 dev board.</div></div></div><div class="jsx-1319436554 jsx-1319436554">This is my first soldering job after a very long time. Fortunately, it worked on the first run and I&#x27;m so happy with it.</div><div class="jsx-1319436554 jsx-1319436554">Now it&#x27;s easy to plug in the device and program it using the Arduino IDE. It&#x27;s not as easy as the Arduino board, but I like it because I designed it (and I know how it works).</div><div class="jsx-1319436554 jsx-1319436554">This is a working setup with my ESP8266 Dev Board:</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-1221164359 jsx-1221164359 container"><img src="https://user-images.githubusercontent.com/50838/31916367-01bc8cb2-b870-11e7-9595-a2b298085650.jpeg" width="650" class="jsx-1221164359 jsx-1221164359"/><div class="jsx-1221164359 jsx-1221164359 title">My ESP8266 dev board in action.</div></div></div><div class="jsx-1319436554 jsx-1319436554">As you can see, now it&#x27;s super clean compared to the previous setup.</div><h3>What&#x27;s the USE of ESP8266?</h3><div class="jsx-1319436554 jsx-1319436554">I should have mentioned this first rather than describing my experiments. There are a lot of things you could with this little device.</div><div class="jsx-1319436554 jsx-1319436554">It could be a base for a WiFi-enabled Smart Bulb or any other connected Smart device.</div><div class="jsx-1319436554 jsx-1319436554">I haven&#x27;t fully explored what we can do with this yet, but I&#x27;ll show you something I did.</div><div class="jsx-1319436554 jsx-1319436554">With this little device, I can connect to my home WiFi network and start a web server inside this chip. Additionally, I can give it a domain name like <span class="jsx-3732062809 jsx-3732062809">arunoda-esp.local</span>. So, I don&#x27;t really need to know the IP address to access the web server.</div><blockquote><div class="jsx-1319436554 jsx-1319436554">This domain name thing was something very interesting to me. It&#x27;s called <a href="https://en.wikipedia.org/wiki/Multicast_DNS">mDNS</a> and used by Apple, Philips Hue and some other smart devices. Frankly, setting that up in ESP8266 was very simple.</div></blockquote><div class="jsx-1319436554 jsx-1319436554">Here&#x27;s the code for everything that I have described:</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-124958280 jsx-124958280 code"><pre style="display:block;background:white;padding:15px;color:#333333;overflow-x:auto;font-size:100%;border-radius:8px;background-color:#eeeeee"><code><span style="color:#969896">#<span>include</span> <span>&lt;ESP8266WiFi.h&gt;</span></span>
<span style="color:#969896">#<span>include</span> <span>&lt;ESP8266WebServer.h&gt;</span></span>
<span style="color:#969896">#<span>include</span> <span>&lt;ESP8266mDNS.h&gt;</span></span>

<span style="color:#a71d5d">const</span> <span style="color:#a71d5d">char</span>* ssid = <span style="color:#df5000">&quot;Arunoda&#x27;s WiFi&quot;</span>;
<span style="color:#a71d5d">const</span> <span style="color:#a71d5d">char</span>* password = <span style="color:#df5000">&quot;password&quot;</span>;

<span style="color:#969896">// Create a web server on port 80</span>
<span>ESP8266WebServer <span style="color:#795da3">server</span><span>(<span>80</span>)</span></span>;

<span><span style="color:#a71d5d">void</span> <span style="color:#795da3">setup</span><span>()</span> </span>{
  Serial.begin(<span>9600</span>);

  <span style="color:#969896">// Connecting to my home WiFi network</span>
  Serial.print(<span style="color:#df5000">&quot;[WiFi] Connecting.&quot;</span>);
  WiFi.begin(ssid, password);

  <span style="color:#a71d5d">while</span>(WiFi.status() != WL_CONNECTED) {
    delay(<span>500</span>);
    Serial.print(<span style="color:#df5000">&#x27;.&#x27;</span>);
  }

  Serial.println(<span style="color:#df5000">&#x27; &#x27;</span>);
  Serial.println(<span style="color:#df5000">&quot;[WiFi] Connected to ssid: &quot;</span> + String(ssid));
  Serial.print(<span style="color:#df5000">&quot;[WiFi] IP: &quot;</span>);
  Serial.println(WiFi.localIP());

  <span style="color:#969896">// Initializing the web server</span>
  server.on(<span style="color:#df5000">&quot;/&quot;</span>, []() {
    server.send(<span>200</span>, <span style="color:#df5000">&quot;text/plain&quot;</span>, <span style="color:#df5000">&quot;Hello World!&quot;</span>);  
  });

  server.begin();
  Serial.println(<span style="color:#df5000">&quot;[Server] Started on port: &quot;</span> + String(<span>80</span>));

  <span style="color:#969896">// Start the MDNS server</span>
  <span style="color:#969896">// With this, I can access this server via </span>
  <span style="color:#969896">// http://arunoda-esp.local on any device connected</span>
  <span style="color:#969896">// to my home WiFi network.</span>
  <span style="color:#a71d5d">if</span> (MDNS.begin(<span style="color:#df5000">&quot;arunoda-esp&quot;</span>)) {
    Serial.println(<span style="color:#df5000">&quot;[MDNS] Serving: arunoda-esp.local&quot;</span>);
  }
}

<span><span style="color:#a71d5d">void</span> <span style="color:#795da3">loop</span><span>()</span> </span>{
  server.handleClient();
}</code></pre></div></div><div class="jsx-1319436554 jsx-1319436554">See, it&#x27;s pretty straightforward. I want to thank <a href="https://github.com/esp8266/Arduino">developers</a> who created these APIs and of course to the manufacturer of ESP8266, <a href="http://espressif.com/">Espressif</a>.</div><div class="jsx-1319436554 jsx-1319436554">I&#x27;ll have to do more experiments and I&#x27;ll try to keep you updated.</div></div></div><button tabindex="0" class="jss16 jss1 jss6 jss11 jss7" type="button" aria-label="scroll-to-top" style="z-index:1800;position:fixed;bottom:24px;top:auto;right:16px;left:auto"><span class="jss2"><svg class="jss19" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></g></svg></span><span class="jss25"></span></button></div></div><div class="jsx-1639712269 jsx-1639712269 footerWrapper"><div class="jsx-1639712269 jsx-1639712269 copyright">© 2018, Pharrell.zx WANG</div></div></main></article></div></div><div id="__next-error"></div><script>
          __NEXT_DATA__ = {"props":{},"page":"/blog/new-hobby-firmwares-and-little-devices","pathname":"/blog/new-hobby-firmwares-and-little-devices","query":{},"buildId":"52542d3b-107e-4191-a6f1-1d6cbed8c95b","assetPrefix":"","nextExport":true,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }

          false
        </script><script async="" id="__NEXT_PAGE__/blog/new-hobby-firmwares-and-little-devices" src="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/page/blog/new-hobby-firmwares-and-little-devices.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/page/_error.js"></script><script src="/_next/52542d3b-107e-4191-a6f1-1d6cbed8c95b/main.js" async=""></script></body></html>