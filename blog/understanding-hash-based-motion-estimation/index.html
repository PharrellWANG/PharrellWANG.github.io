<!DOCTYPE html><html lang="en" dir="ltr"><head><meta charSet="utf-8" class="next-head next-head"/><title class="jsx-2266256742 jsx-2266256742 next-head">Understanding Hash-based Motion Estimation</title><meta name="description" content="An attempt to explain Hash-based Motion Estimation in VVC." class="jsx-2266256742 jsx-2266256742 next-head"/><link rel="preload" href="/_next/f789d539-6630-443e-8e67-f587b59f4585/page/blog/understanding-hash-based-motion-estimation.js" as="script"/><link rel="preload" href="/_next/f789d539-6630-443e-8e67-f587b59f4585/page/_error.js" as="script"/><link rel="preload" href="/_next/f789d539-6630-443e-8e67-f587b59f4585/main.js" as="script"/><style id="jss-server-side"></style><style id="__jsx-1319436554">.jsx-1319436554{margin:15px 0;}</style><style id="__jsx-124958280">.code.jsx-124958280{margin:30px 0;}</style><style id="__jsx-138357423">.no_marginp.jsx-138357423{margin:0.5px 0 0 0;font-weight:400;}</style><style id="__jsx-3404387533">div.jsx-3404387533{background-color:#e1f5fe;padding:5px 5px 5px 5px;margin:1px 0;color:#01579b;border-radius:5px;}.widgets_div.jsx-3404387533{border-bottom:thin #edf1f2 solid;padding:0.5px 0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.widgets_div.jsx-3404387533 .icon_div.jsx-3404387533{display:inline-block;font-size:24px;}.text_div.jsx-3404387533{display:inline-block;margin:0.5px 0 0 0;padding:5px 5px 5px 0px;}</style><style id="__jsx-4281566797">.indentRow.jsx-4281566797{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;}.p.jsx-4281566797{margin:15px 0;}</style><style id="__jsx-3736279659">.spanPaddingRight.jsx-2266256742{display:block;margin:0 auto 0 auto;max-width:650px;padding:0 21px;}.span.jsx-2266256742{padding-left:30px;}.backIcon.jsx-2266256742{padding-right:6px;}a.jsx-2266256742{color:#fff;-webkit-text-decoration:none;text-decoration:none;opacity:1;}a.jsx-2266256742:hover{color:#fefefe;-webkit-text-decoration:none;text-decoration:none;opacity:0.6;}.footerWrapper.jsx-2266256742{margin-top:72px;background:#f2f2f2;height:120px;z-index:1100;font-size:12px;color:gray;}.copyright.jsx-2266256742{-webkit-flex:1;-ms-flex:1;flex:1;padding-top:36px;text-align:center;}.headerTop.jsx-2266256742{padding-top:13px;padding-bottom:13px;background-color:#333;}.outerContainer.jsx-2266256742{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;min-height:100vh;-webkit-flex-direction:column;-ms-flex-direction:column;flex-direction:column;background-color:#fafafa;width:100%;height:100%;}.innerContainer.jsx-2266256742{padding:0 21px;-webkit-flex:1;-ms-flex:1;flex:1;}.content.jsx-2266256742{margin:0 auto 0 auto;max-width:650px;padding-top:24px;}.content.jsx-2266256742 h1.jsx-2266256742{font-size:1.5rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.15417em;color:rgba(0,0,0,0.54);}.date.jsx-2266256742{color:#888;font-size:12px;padding-top:3px;}.markdown-content.jsx-2266256742{margin:50px 0 0 0;}</style><style id="__jsx-76096356">.markdown-content{color:rgba(0,0,0,0.87);line-height:1.46429em;font-size:0.9rem;font-weight:400;}.markdown-content hr{border:0;border-bottom:1px solid #8bc34a;margin:40px 60px;}.markdown-content a{color:#1e88e5;-webkit-text-decoration:none;text-decoration:none;border-bottom:1px solid #1e88e5;}.markdown-content strong{font-weight:500;-webkit-text-decoration:green wavy underline;text-decoration:green wavy underline;}.markdown-content li{margin:10px 0;}.markdown-content h2{font-size:1.2rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.15417em;color:rgba(0,0,0,0.87);}.markdown-content h3{font-size:0.9rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.10417em;text-transform:uppercase;color:rgba(0,0,0,0.87);}.markdown-content h4{font-size:0.9rem;font-weight:500;font-family:Roboto,Helvetica,Arial,sans-serif;line-height:1.10417em;color:rgba(0,0,0,0.87);}.markdown-content blockquote{padding:1px 0 1px 10px;margin:0;border-left:5px solid #8bc34a;}</style><style id="__jsx-1580160015"></style><style id="__jsx-3994937953">body{font-family:Roboto,-apple-system,BlinkMacSystemFont,'Segoe UI', Helvetica,Arial,sans-serif,'Apple Color Emoji','Segoe UI Emoji', 'Segoe UI Symbol';padding:0;margin:0;-webkit-font-smoothing:antialiased;}</style><title>Pharrell&#x27;s Website</title><link href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.9.0/katex.min.css" rel="stylesheet"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css"/><meta charSet="utf-8"/><meta name="viewport" content="user-scalable=0, initial-scale=1, minimum-scale=1, width=device-width, height=device-height"/><meta name="theme-color" content="#333"/><link rel="favicon.ico" sizes="512x512" href="/static/favicons/favicon.ico"/><link rel="apple-touch-icon" sizes="72x72" href="/static/favicons/icon-72x72.png"/><link rel="apple-touch-icon" sizes="120x120" href="/static/favicons/icon-120x120.png"/><link rel="apple-touch-icon" sizes="144x144" href="/static/favicons/icon-144x144.png"/><link rel="apple-touch-icon" sizes="152x152" href="/static/favicons/icon-152x152.png"/><link rel="apple-touch-icon" sizes="167x167" href="/static/favicons/icon-167x167.png"/><link rel="apple-touch-icon" sizes="180x180" href="/static/favicons/icon-180x180.png"/><link rel="apple-touch-icon" sizes="192x192" href="/static/favicons/icon-192x192.png"/><link rel="apple-touch-icon" sizes="384x384" href="/static/favicons/icon-384x384.png"/><link rel="apple-touch-icon" sizes="512x512" href="/static/favicons/icon-512x512.png"/><link rel="icon" type="image/png" href="/static/favicons/favicon.ico" sizes="512x512"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500"/><link href="https://fonts.googleapis.com/css?family=Kalam" rel="stylesheet"/><script src="/static/js/gitalk.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-MML-AM_CHTML" async=""></script></head><body><div id="__next"><div class="jsx-4078088743 jsx-4078088743" data-reactroot=""><article class="jsx-4078088743 jsx-4078088743"><main class="jsx-2266256742 jsx-2266256742 outerContainer"><div class="jsx-2266256742 jsx-2266256742 headerTop"><span class="jsx-2266256742 jsx-2266256742 spanPaddingRight"><a class="jsx-2266256742 jsx-2266256742" href="/blog/">&lt; Back</a></span></div><div class="jsx-2266256742 jsx-2266256742 innerContainer"><div class="jsx-2266256742 jsx-2266256742 content"><div class="jsx-2266256742 jsx-2266256742 date">July 4, 2019</div><h1 class="jsx-2266256742 jsx-2266256742">Understanding Hash-based Motion Estimation</h1><div class="jsx-2266256742 jsx-2266256742 markdown-content"><div class="jsx-138357423 _markdown_"><div class="jsx-1319436554 jsx-1319436554">The post attempts to explain Hash-based Motion Estimation (HBME), which is a new technique in VVC compared with HEVC.</div><h2>Motivation</h2><div class="jsx-1319436554 jsx-1319436554">During the development of HEVC SCC, it is believed that hash-based motion search can overcome some shortcomings of conventional motion estimation. (But... has it been proposed for SCC previously? Readers who are experienced with SCC may share insights in comment section.)</div><ol><li><strong>Find blocks that match better</strong>: search range of HBME can be full picture instead of a local region. For screen contents, conventional motion search may not work well due to the limited search range.</li><li><strong>expedite ME progress</strong>: in HBME, once a match will be found, the following checks can be early terminated.</li></ol><h2>Procedure</h2><h2>Details</h2><ol><li>HBME is only allowed in NEXT profile [1] (Review of profile is available in last section).</li><li>HBME is performed for 4x4, 4x8, 8x4, 8x8, 16x16, 32x32 and 64x64 blocks.</li><li>For inter coding, the HBME is performed before all coding modes.</li></ol><h2>Review</h2><h3>Profile, Level and Tier</h3><div class="jsx-1319436554 jsx-1319436554">In this section, the concepts of profile, level and tier in standards are reviewed.</div><div class="jsx-1319436554 jsx-1319436554">Some variation in capabilities of the standard is necessary to support a broad range of applications. This variation is handled by specifying profiles, levels and tiers.</div><div class="jsx-1319436554 jsx-1319436554">A <strong>profile</strong> defines the set of coding tools which may be used to encode a video sequence into a bitstream. The encoder is not required to use all coding tools available in the profile but may select the coding tools which it considers to be suitable [2]. A set of allowed profiles in VTM4.0 is shown below.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-124958280 jsx-124958280 code"><pre style="display:block;background:white;padding:8px;color:#333333;overflow-x:auto;font-size:100%;border-radius:5px;background-color:#eeeeee"><code><span style="color:#969896">// Profiles defined in VTM4.0</span>
<span style="color:#a71d5d">namespace</span> Profile{
  <span style="color:#a71d5d">enum</span> Name {
    NONE = <span>0</span>, MAIN = <span>1</span>, MAIN10 = <span>2</span>, MAINSTILLPICTURE = <span>3</span>,
    MAINREXT = <span>4</span>, HIGHTHROUGHPUTREXT = <span>5</span>, NEXT = <span>6</span> }; }</code></pre></div></div><div class="jsx-1319436554 jsx-1319436554">A <strong>level</strong> defines the degree of capability given a profile. Levels/degrees of capability are defined to establish the picture resolution, frame rate, bit rate, buffering capacity, and other aspects that are matters of degree rather than basic feature sets/coding tools.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-3404387533 jsx-3404387533"><div class="jsx-3404387533 jsx-3404387533 widgets_div"><div class="jsx-3404387533 jsx-3404387533 icon_div"><svg class="jss43" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M12 17.27L18.18 21l-1.64-7.03L22 9.24l-7.19-.61L12 2 9.19 8.63 2 9.24l5.46 4.73L5.82 21z"></path></g></svg></div><div class="jsx-3404387533 jsx-3404387533 text_div"><div class="jsx-138357423 jsx-138357423"><p class="jsx-138357423 jsx-138357423 no_marginp">In HEVC, <ins class="jsx-138357423 jsx-138357423">Level 1</ins> only handles 176x144 resolution at 15 fps, whereas <ins class="jsx-138357423 jsx-138357423">level 4.1</ins> would be capable of 1920x1080 HDTV at 60 fps, and levels in version 1 are defined up to <ins class="jsx-138357423 jsx-138357423">level 6.1</ins>, which is capable of 8192x4320 video resolution at up to 120 fps. <br class="jsx-138357423 jsx-138357423"/></p></div></div></div></div></div><div class="jsx-1319436554 jsx-1319436554">In each level, <strong>tiers</strong> are defined based on the bit rates they are capable of handling. Main Tier is mainly used to meet the demand of consumer usage, while High Tier is used to provide adequate quality for professional usage than what would be necessary for consumer applications. Levels and tiers defined in VTM4.0 are shown below.</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-124958280 jsx-124958280 code"><pre style="display:block;background:white;padding:8px;color:#333333;overflow-x:auto;font-size:100%;border-radius:5px;background-color:#eeeeee"><code><span style="color:#969896">// Tiers and Levels defined in VTM4.0</span>
<span style="color:#a71d5d">namespace</span> Level{
  <span style="color:#a71d5d">enum</span> Tier { MAIN = <span>0</span>, HIGH = <span>1</span>, };
  <span style="color:#a71d5d">enum</span> Name {
    NONE     = <span>0</span>,   LEVEL1   = <span>30</span>,  LEVEL2   = <span>60</span>,  LEVEL2_1 = <span>63</span>,  LEVEL3   = <span>90</span>,
    LEVEL3_1 = <span>93</span>,  LEVEL4   = <span>120</span>, LEVEL4_1 = <span>123</span>, LEVEL5   = <span>150</span>, LEVEL5_1 = <span>153</span>,
    LEVEL5_2 = <span>156</span>, LEVEL6   = <span>180</span>, LEVEL6_1 = <span>183</span>, LEVEL6_2 = <span>186</span>, LEVEL8_5 = <span>255</span>, }; }</code></pre></div></div><hr/><div class="jsx-1319436554 jsx-1319436554">References</div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-4281566797 jsx-4281566797 indentRow"><p class="jss1 jss10 jss18">[<!-- -->1<!-- -->]  </p><p class="jss1 jss10 jss18">J. Xu, J. Li, K. Zhang, L. Zhang, H. Liu, Y. Wang, P. Zhao, D. Hong, R. Xiong,  &#x27;Non-CE8: Hash-based Motion Search&#x27;, Joint Video Exploration Team (JVET), docs. JVET-M0253, 2019.</p></div></div><div class="jsx-1319436554 jsx-1319436554"><div class="jsx-4281566797 jsx-4281566797 indentRow"><p class="jss1 jss10 jss18">[<!-- -->2<!-- -->]  </p><p class="jss1 jss10 jss18">V. Sze, M. Budagavi, and G. J. Sullivan (Editors),  High Efficiency Video Coding (HEVC) Algorithms and Architectures (Integrated Circuits and Systems).  Dordrecht: Springer, 2014.</p></div></div></div></div><button tabindex="0" class="jss40 jss25 jss30 jss35 jss29" type="button" aria-label="scroll-to-top" style="z-index:1800;position:fixed;bottom:24px;top:auto;right:16px;left:auto"><span class="jss26"><svg class="jss43" focusable="false" viewBox="0 0 24 24" aria-hidden="true"><g><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"></path></g></svg></span><span class="jss49"></span></button><div id="gitalk-container" class="jsx-2266256742 jsx-2266256742"></div></div></div><div class="jsx-2266256742 jsx-2266256742 footerWrapper"><div class="jsx-2266256742 jsx-2266256742 copyright">© 2019, Pharrell</div></div></main></article></div></div><div id="__next-error"></div><script>
          __NEXT_DATA__ = {"props":{},"page":"/blog/understanding-hash-based-motion-estimation","pathname":"/blog/understanding-hash-based-motion-estimation","query":{},"buildId":"f789d539-6630-443e-8e67-f587b59f4585","assetPrefix":"","nextExport":true,"err":null,"chunks":[]}
          module={}
          __NEXT_LOADED_PAGES__ = []
          __NEXT_LOADED_CHUNKS__ = []

          __NEXT_REGISTER_PAGE = function (route, fn) {
            __NEXT_LOADED_PAGES__.push({ route: route, fn: fn })
          }

          __NEXT_REGISTER_CHUNK = function (chunkName, fn) {
            __NEXT_LOADED_CHUNKS__.push({ chunkName: chunkName, fn: fn })
          }

          false
        </script><script async="" id="__NEXT_PAGE__/blog/understanding-hash-based-motion-estimation" src="/_next/f789d539-6630-443e-8e67-f587b59f4585/page/blog/understanding-hash-based-motion-estimation.js"></script><script async="" id="__NEXT_PAGE__/_error" src="/_next/f789d539-6630-443e-8e67-f587b59f4585/page/_error.js"></script><script src="/_next/f789d539-6630-443e-8e67-f587b59f4585/main.js" async=""></script></body></html>